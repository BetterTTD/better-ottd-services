version: '3.4'

services:
  db:
    image: mcr.microsoft.com/mssql/server:2019-GA-ubuntu-16.04
    container_name: ${DOCKER_REGISTRY-}tg.db
    networks:
      - tg
    environment:
      SA_PASSWORD: "Your_password123"
      ACCEPT_EULA: "Y"

  seq:
    image: datalust/seq:latest
    container_name: ${DOCKER_REGISTRY-}tg.seq
    networks:
      - tg
    environment:
      ACCEPT_EULA: "Y"

  openttd.admin.client:
    image: ${DOCKER_REGISTRY-}openttd.admin.client
    networks:
      - tg
    depends_on:
      - db
      - seq
    build: 
      context: .
      dockerfile: Services/OpenTTD/OpenTTD.AdminClient/Dockerfile

  openttd.api:
    image: ${DOCKER_REGISTRY-}openttd.api
    networks:
      - tg
    depends_on:
      - openttd.admin.client
    build:
      context: .
      dockerfile: Services/OpenTTD/OpenTTD.API/Dockerfile

  admin.server:
    image: ${DOCKER_REGISTRY-}admin.server
    networks:
      - tg
    depends_on:
      - openttd.api
    build:
      context: .
      dockerfile: WebApps/Admin/Admin.Server/Dockerfile

  admin.client:
    image: ${DOCKER_REGISTRY-}admin.client
    networks:
      - tg
    depends_on:
      - admin.server
    build:
      context: .
      dockerfile: WebApps/Admin/Admin.Client/Dockerfile


networks:
  tg:
    name: tg.network